(this["webpackJsonpreact-auth-template"]=this["webpackJsonpreact-auth-template"]||[]).push([[0],{123:function(e,t,a){"use strict";a.r(t);var r,n=a(0),s=a(30),c=a.n(s),o=(a(90),a(3)),u=a(17),i=a(15),l=Object(n.createContext)(),d=a(2),j="SET_USERNAME",b="SET_USER_ID",m="SET_TOKEN",p="SET_SIGNEDIN",O="SET_ROOMS_ID",h="SET_STATE",f="SET_SERVER_USERS",x="ADD_CACHE",g=[j,b,m,p,O,f,h],v=function(e,t){switch(t.type){case x:return null===t.payload?Object(d.a)(Object(d.a)({},e),{},{cachedPfps:[]}):Object(d.a)(Object(d.a)({},e),{},{cachedPfps:t.payload});case j:return null===t.payload?Object(d.a)(Object(d.a)({},e),{},{userName:null}):Object(d.a)(Object(d.a)({},e),{},{userName:t.payload});case b:case b:return null===t.payload?Object(d.a)(Object(d.a)({},e),{},{userId:null}):Object(d.a)(Object(d.a)({},e),{},{userId:t.payload});case m:return null===t.payload?Object(d.a)(Object(d.a)({},e),{},{token:null}):Object(d.a)(Object(d.a)({},e),{},{token:t.payload});case p:return null===t.payload?Object(d.a)(Object(d.a)({},e),{},{loggedIn:!1}):Object(d.a)(Object(d.a)({},e),{},{loggedIn:t.payload});case O:return null===t.payload?Object(d.a)(Object(d.a)({},e),{},{rooms:null}):Object(d.a)(Object(d.a)({},e),{},{rooms:t.payload});case f:return null===t.payload?Object(d.a)(Object(d.a)({},e),{},{serverUsers:null}):Object(d.a)(Object(d.a)({},e),{},{serverUsers:t.payload});case h:return null===t.payload?Object(d.a)(Object(d.a)({},e),{},{shouldSaveState:!1}):Object(d.a)(Object(d.a)({},e),{},{shouldSaveState:t.payload});default:return e}},w=a(13),N=a(16),y=a(7),S=a.n(y),C=a(14),k=a(131),E="https://gg-chat-api.herokuapp.com",I="http://localhost:3040",P="localhost"===window.location.hostname?I:E,T=a(18),_=a.n(T),R=function(e){return _()({method:"DELETE",url:P+"/delete-account",headers:{Authorization:"Bearer ".concat(e)}})},D=function(){var e=Object(C.a)(S.a.mark((function e(t,a){var r,n,s;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t,(n=new FormData).append("pfp",r),s={method:"POST",body:n},e.abrupt("return",fetch(P+"/upload/"+a,s));case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),L=function(e){return _()({url:P+"/sign-in/",method:"POST",data:{credentials:{userName:e.userName,password:e.password}}})},B=a(132),F=a(8),U=a(44),A=a(1),G=function(e){var t=e.closeModal,a=Object(n.useContext)(l),r=a.state,s=(a.dispatch,Object(i.f)()),c=r.loggedIn,u=r.token,d=Object(n.useState)(""),j=Object(o.a)(d,2),b=j[0],m=j[1],p=Object(n.useState)(""),O=Object(o.a)(p,2),h=O[0],f=O[1];return c?Object(A.jsx)("div",{className:"row changePass-parent-wrapper ",children:Object(A.jsx)("div",{className:"changePass-form-wrapper",children:Object(A.jsxs)(F.a,{className:"changePass-form",children:[Object(A.jsxs)(F.a.Group,{controlId:"oldPassword",children:[Object(A.jsx)(F.a.Label,{children:"Old password"}),Object(A.jsx)(F.a.Control,{required:!0,name:"oldPassword",value:b,type:"password",placeholder:"Old Password",onChange:function(e){return m(e.target.value)}})]}),Object(A.jsxs)(F.a.Group,{controlId:"newPassword",children:[Object(A.jsx)(F.a.Label,{children:"New Password"}),Object(A.jsx)(F.a.Control,{required:!0,name:"newPassword",value:h,type:"password",placeholder:"New Password",onChange:function(e){return f(e.target.value)}})]}),Object(A.jsx)(U.a,{variant:"primary",type:"button",onClick:function(){(function(e,t){return _()({url:P+"/change-password/",method:"PATCH",headers:{Authorization:"Bearer ".concat(t)},data:{passwords:{old:e.old,new:e.new}}})})({old:b,new:h},u).then((function(e){t()})).then((function(){return s.push("/")})).catch((function(e){f(""),m("")}))},children:"Submit"})]})})}):Object(A.jsx)(i.a,{to:"/"})},z=function(e){e.title;var t=Object(n.useState)(!1),a=Object(o.a)(t,2),r=a[0],s=a[1],c=function(){return s(!1)};return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(N.b,{to:"/change-password",className:"nav-link",onClick:function(){return s(!0)},children:"Change Password"}),Object(A.jsxs)(B.a,{show:r,onHide:c,centered:!0,children:[Object(A.jsx)(B.a.Header,{closeButton:!0,children:Object(A.jsx)(B.a.Title,{className:"changePass-modal-title",children:"Change Password"})}),Object(A.jsx)(B.a.Body,{children:Object(A.jsx)(i.b,{path:"/change-password",render:function(){return Object(A.jsx)(G,{closeModal:c})}})})]})]})},H=function(e){var t=e.closeModal,a=Object(n.useContext)(l),r=a.state,s=(a.dispatch,r.loggedIn),c=Object(n.createRef)(),o=function(){var e=Object(C.a)(S.a.mark((function e(a){var n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),console.log(c.current.files[0]),e.next=4,D(c.current.files[0],r.userName);case 4:if(n=e.sent,console.log("upload status: ",n),200!==n.status){e.next=12;break}return w.b.success("Profile image changed successfully!"),t(),e.abrupt("return",!0);case 12:return w.b.error("Failed to change profile image"),t(),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return s?Object(A.jsx)("div",{className:"row sigin-parent-wrapper",children:Object(A.jsx)("div",{className:"sigin-form-wrapper",children:Object(A.jsxs)(F.a,{className:"signin-form",onSubmit:o,children:[Object(A.jsx)(F.a.Group,{children:Object(A.jsx)(F.a.Control,{type:"file",name:"image",id:"imagePicker",accept:"image/*",multiple:!1,ref:c})}),Object(A.jsx)(U.a,{variant:"primary",type:"submit",children:"Submit"})]})})}):Object(A.jsx)(i.a,{to:"/"})},q=function(e){e.title;var t=Object(n.useState)(!1),a=Object(o.a)(t,2),r=a[0],s=a[1],c=function(){return s(!1)};return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(N.b,{to:"/upload-image",className:"nav-link",onClick:function(){return s(!0)},children:"Upload Image"}),Object(A.jsxs)(B.a,{show:r,onHide:c,centered:!0,children:[Object(A.jsx)(B.a.Header,{children:Object(A.jsx)(B.a.Title,{className:"changePass-modal-title",children:"Change Profile Image"})}),Object(A.jsx)(B.a.Body,{children:Object(A.jsx)(i.b,{path:"/upload-image",render:function(e){return Object(A.jsx)(H,{closeModal:c})}})})]})]})},M=function(e){var t=e.user,a=Object(n.useState)(!1),r=Object(o.a)(a,2),s=(r[0],r[1],Object(n.useContext)(l)),c=s.state,u=s.dispatch,d=c.token,j=Object(i.f)(),b=function(){var e=Object(C.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R(d);case 2:200===e.sent.status?(Object(w.b)("Successfully deleted account!"),g.forEach((function(e){u({type:e,payload:null})})),j.push("/")):Object(w.b)("Failed to delete account",{type:"error"});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(A.jsx)(A.Fragment,{children:Object(A.jsxs)(k.a,{className:"parent-dropdown-wrapper",children:[Object(A.jsx)(k.a.Toggle,{className:"dropdown-username",children:t.userName}),Object(A.jsxs)(k.a.Menu,{className:"dropdown-menu",children:[Object(A.jsx)(q,{}),Object(A.jsx)(z,{}),Object(A.jsx)(k.a.Divider,{className:"divider"}),Object(A.jsx)(N.b,{to:"/sign-out",className:"nav-link",children:"Sign Out"}),Object(A.jsx)(k.a.Divider,{className:"divider"}),Object(A.jsx)("span",{onClick:function(){return b()},style:{color:"red",fontWeight:"800"},className:"nav-link",children:"Delete Account"})]})]})})},J=function(e){return Object(A.jsx)(A.Fragment,{children:Object(A.jsx)(M,{user:e})})},Y=Object(A.jsxs)(n.Fragment,{children:[Object(A.jsx)(N.b,{to:"/sign-in",className:"link login",children:"Login"}),Object(A.jsx)(N.b,{to:"/sign-up",className:"link register",children:"Register"})]}),K=function(){var e=Object(n.useContext)(l),t=e.state,a=(e.dispatch,t);return Object(A.jsxs)("div",{className:"header-wrapper",children:[Object(A.jsx)("div",{className:"logo-wrapper",children:Object(A.jsx)(N.b,{to:"/",className:"link",children:Object(A.jsx)("span",{className:"logo-text",children:"Oui Chat"})})}),Object(A.jsx)("div",{className:"links-group-1",children:a.loggedIn?J(a):Y})]})},V=a(42),W=a(129),Q=a(130),X=a(80),Z=a(84),$=function(e){var t=e.received,a=e.room,r=Object(n.useContext)(l),s=r.state,c=(r.dispatch,s.loggedIn,s.userId,s.token),u=s.userName,i=Object(n.useState)(""),d=Object(o.a)(i,2),j=d[0],b=d[1],m=Object(n.useState)(null),p=Object(o.a)(m,2),O=p[0],h=p[1],f=Object(n.useState)(!1),x=Object(o.a)(f,2),g=x[0],v=x[1],N=Object(n.useState)(!1),y=Object(o.a)(N,2),S=(y[0],y[1]);Object(n.useEffect)((function(){if(!g){var e=Object(Z.a)(P,{withCredentials:!1,query:{token:c}});e.on("connect",(function(){window.socket=e})),e.on("loggedin",(function(a){a?(S(!0),e.on("message",t),e.on("unauthorized",(function(){Object(w.b)("Unauthorized",{type:"error"})}))):Object(w.b)("failed to log in")})),h(e),v(!0)}}),[]),Object(n.useEffect)((function(){a&&O.emit("join",{roomId:a})}),[a]);return Object(A.jsx)(A.Fragment,{children:""!==a?Object(A.jsxs)("form",{className:"message-input-window",onSubmit:function(e){if(e.preventDefault(),O){var t={message:j,roomId:a,timestamp:(new Date).toLocaleString(),userName:u};O.emit("send-message",t),b("")}},children:[Object(A.jsx)("input",{value:j,onChange:function(e){return b(e.target.value)},className:"message-input"}),Object(A.jsx)("button",{type:"submit",className:"send-message",children:"Send"})]}):""})},ee=function(){var e=Object(C.a)(S.a.mark((function e(t,a,r){var n,s,c,o;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=window.sessionStorage,s=t.filter((function(e){return!a.some((function(t){return t!==e._id}))})),e.prev=2,e.next=5,Promise.all(s.map(function(){var e=Object(C.a)(S.a.mark((function e(t){var a,r,n,s;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={userName:t.userName},e.next=3,fetch(P+"/img/"+t.userName);case 3:return r=e.sent,n=r.headers.get("Content-Type"),e.next=7,r.arrayBuffer();case 7:return s=e.sent,a.data=ae(n,s),e.abrupt("return",a);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:return c=e.sent,o=0===a.length?[]:Object(V.a)(a),c.forEach((function(e){n.setItem(e.userName,e.data),o.push(e.userName)})),r({type:x,payload:o}),e.abrupt("return",!0);case 12:return e.prev=12,e.t0=e.catch(2),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(t,a,r){return e.apply(this,arguments)}}(),te=function(e){var t=window.sessionStorage.getItem(e);return t||P+"/img/"+e},ae=function(e,t){var a="data:".concat(e,";base64,"),r="";return new Uint8Array(t).forEach((function(e){return r+=String.fromCharCode(e)})),a+window.btoa(r)},re={color:"rgba(123, 115, 115, .85)"},ne=function(e){e.userName;return Object(A.jsxs)("div",{className:"message-layout",children:[Object(A.jsx)("img",{col:"1",className:"userImage",src:te(e.userName)}),Object(A.jsxs)("li",{col:"2",children:[Object(A.jsx)("strong",{children:e.userName})," ",Object(A.jsx)("a",{style:re,children:e.timestamp}),":",Object(A.jsx)("br",{}),Object(A.jsx)("section",{className:"message-text",children:e.text})]})]})},se=function(e){var t=e.room;return Object(n.useEffect)((function(){}),[t]),Object(A.jsx)(A.Fragment,{children:t?Object(A.jsx)("h3",{className:"room-title",children:t}):""})},ce=function(e,t,a){return _()({method:"POST",url:P+"/create-room",headers:{Authorization:"Bearer ".concat(a)},data:{room:{name:e},userId:t}})},oe=function(e){return _()({method:"GET",url:P+"/show-rooms",headers:{Authorization:"Bearer ".concat(e)}})},ue=function(e){return _()({method:"DELETE",url:P+"/go-offline",headers:{Authorization:"Bearer ".concat(e)}})},ie=function(e){return _()({method:"GET",url:P+"/show-server-users",headers:{Authorization:"Bearer ".concat(e)}})},le=function(e){var t=e.name,a=e.status,r=e.add,s=e.userId;return Object(n.useEffect)((function(){}),[a]),Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("img",{col:"1",className:"user-image",src:te(t)}),Object(A.jsx)("span",{className:"user-name",children:t}),Object(A.jsx)("span",{className:"user-status",children:"online"===a?Object(A.jsx)("img",{src:"https://icongr.am/octicons/rss.svg?size=16&color=36ba38"}):""}),Object(A.jsx)("img",{src:"https://icongr.am/octicons/plus.svg?size=16&color=b3b3b3",onClick:function(){return r(s)}})]})},de=function(e,t,a){return _()({method:"POST",url:P+"/add-user-to-room",headers:{Authorization:"Bearer ".concat(a)},data:{roomId:e,userId:t}})},je=function(e){var t=e.currentRoom,a=Object(n.useContext)(l),r=a.state,s=a.dispatch,c=r.serverUsers,u=r.token,i=Object(n.useState)(null),d=Object(o.a)(i,2),j=d[0],b=d[1],m=function(){var e=Object(C.a)(S.a.mark((function e(a){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&""!==t){e.next=3;break}return Object(w.b)("Please select a room in order to add users."),e.abrupt("return");case 3:return e.next=5,de(t,a,u);case 5:if(201!==e.sent.status){e.next=11;break}return Object(w.b)("User successfully added to room!",{type:"success"}),e.abrupt("return");case 11:return Object(w.b)("You may not add a user to that room.",{type:"error"}),e.abrupt("return");case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(C.a)(S.a.mark((function e(){var t,a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie(u);case 2:return a=e.sent,t=a.data.user,e.next=6,s({type:f,payload:t});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){p();var e=setInterval(p,5e3);window.intervalId=e}),[]),Object(n.useEffect)(Object(C.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c&&b(c.map((function(e){return Object(A.jsx)("li",{className:"user-list-item",children:Object(A.jsx)(le,{name:e.userName,userId:e._id,add:m,status:e.status})},e._id)})));case 1:case"end":return e.stop()}}),e)}))),[c]),Object(A.jsx)("ul",{className:"user-list",children:j})},be=function(e){var t=e.setRoomName,a=e.onCreateRoom,r=e.roomName,s=Object(n.useState)(!1),c=Object(o.a)(s,2),u=c[0],i=c[1];return Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(U.a,{className:"create-room-button",onClick:function(){return i(!0)},children:Object(A.jsx)("span",{className:"create-room-span",children:"+"})}),Object(A.jsxs)(B.a,{show:u,onHide:function(){return i(!1)},centered:!0,children:[Object(A.jsx)(B.a.Header,{closeButton:!0,children:Object(A.jsx)(B.a.Title,{className:"createRoom-modal-title",children:"Create Room"})}),Object(A.jsx)(B.a.Body,{children:Object(A.jsx)(F.a,{onSubmit:function(e){a(e)&&i(!1)},children:Object(A.jsxs)(F.a.Group,{controlId:"room-name",children:[Object(A.jsx)(F.a.Control,{required:!0,type:"room-name",name:"create-room",value:r,placeholder:"Enter Room Name",onChange:function(e){return t(e.target.value)}}),Object(A.jsx)("button",{type:"submit",className:"create-button",children:"Create"})]})})})]})]})},me=function(){var e=Object(C.a)(S.a.mark((function e(t,a){var r;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_()({method:"GET",url:P+"/room/"+a,headers:{Authorization:"Bearer ".concat(t)}});case 2:if(0!==(r=e.sent).data.length){e.next=5;break}return e.abrupt("return",null);case 5:return e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),pe=function(){var e=Object(n.useContext)(l),t=e.state,a=e.dispatch,r=Object(n.useState)([]),s=Object(o.a)(r,2),c=s[0],u=s[1],i=Object(n.useState)([]),d=Object(o.a)(i,2),j=d[0],b=d[1],m=Object(n.useState)(null),p=Object(o.a)(m,2),h=p[0],f=p[1],x=Object(n.useState)(""),g=Object(o.a)(x,2),v=g[0],N=g[1],y=t.rooms,k=t.userId,E=t.token,I=t.serverUsers,P=t.cachedPfps,T=Object(n.useState)(null),_=Object(o.a)(T,2),R=_[0],D=_[1],L=Object(n.useState)(null),B=Object(o.a)(L,2),F=(B[0],B[1],Object(n.useState)("")),U=Object(o.a)(F,2),G=U[0],z=U[1],H=Object(n.useState)(""),q=Object(o.a)(H,2),M=q[0],J=q[1],Y=Object(n.useState)(""),K=Object(o.a)(Y,2),Z=K[0],te=K[1],ae=Object(n.useState)(""),re=Object(o.a)(ae,2),ie=re[0],le=re[1];Object(n.useEffect)((function(){I&&0!==I.length&&ee(I,P,a).then((function(e){}))}),[I]);var de=function e(t){if(t){Object(w.b)("Successfully deleted room!",{type:"success"});var r=y.filter((function(e){return e._id!==t}));a({type:O,payload:r})}else Object(w.b)("You may not delete that room.",{type:"error"});window.socket.removeEventListener("deleted",e)};Object(n.useEffect)((function(){M!==G&&(u([]),z(M),te(ie))}),[M]),Object(n.useEffect)((function(){""!==G&&me(E,G).then((function(e){if(e){var t=e.map((function(e){return{userName:e.userName,timestamp:e.sentAt,message:e.text}}));u(t)}}))}),[G]),Object(n.useEffect)((function(){(null===y||void 0===y?void 0:y.length)>0&&D(y.map((function(e){return Object(A.jsxs)("li",{className:"room-list-item",children:[Object(A.jsx)("a",{href:"#",className:"room-name-link",onClick:function(){return function(e,t){J(e),le(t)}(e._id,e.name)},children:"".concat(e.name)}),Object(A.jsx)("img",{className:"trash",src:"https://icongr.am/octicons/trash.svg?size=16&color=FFFFFF",onClick:function(){return function(e){var t={roomId:e,timestamp:(new Date).toLocaleString(),userId:k};z(""),te(""),window.socket.emit("delete-room",t),window.socket.addEventListener("deleted",de)}(e._id)}})]},"".concat(e._id))})))}),[y]);var pe=function(){var e=Object(C.a)(S.a.mark((function e(){var t,r;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,oe(E);case 3:r=e.sent,r.data.room.forEach((function(e){e.validUsers.includes(k)&&t.push(e)})),a({type:O,payload:t});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)(Object(C.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:pe(),t=setInterval(pe,5e3),window.roomIntervalId=t,window.addEventListener("beforeunload",(function(){ue(E,k)}),!1);case 4:case"end":return e.stop()}}),e)}))),[]);var Oe=function(){var e=Object(C.a)(S.a.mark((function e(t){var r,n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),r=[],e.next=4,ce(v,k,E);case 4:if(n=e.sent){e.next=7;break}return e.abrupt("return",!1);case 7:return y.length>0?(r=Object(V.a)(y)).push(n.data.room):r=[n.data.room],a({type:O,payload:r}),e.abrupt("return",!0);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){if(h){var e=Object(V.a)(c);e.push(h),u(e),f(null)}}),[h]),Object(n.useEffect)((function(){b(c.map((function(e,t){return Object(A.jsx)(ne,{userName:e.userName,timestamp:e.timestamp,text:e.message},e.userName+t.toString())})))}),[c]),Object(A.jsx)(W.a,{className:"main-container",children:Object(A.jsxs)(Q.a,{className:"top-row",children:[Object(A.jsxs)(X.a,{className:"col-3 left-side-options",children:[Object(A.jsx)("div",{className:"room-title-alt",children:Object(A.jsx)(se,{room:Z})}),Object(A.jsxs)("div",{className:"left-side-nav",children:[Object(A.jsx)(Q.a,{className:"room-top-level",children:Object(A.jsxs)("div",{className:"rooms-div",children:[Object(A.jsx)("h4",{className:"roomsHeader",children:"Rooms"}),Object(A.jsx)(be,{onCreateRoom:Oe,roomName:v,setRoomName:N})]})}),Object(A.jsx)(Q.a,{children:Object(A.jsx)("section",{className:"open-rooms",children:Object(A.jsx)("ul",{className:"room-list",children:R})})})]}),Object(A.jsxs)(Q.a,{className:"active-users",children:[Object(A.jsx)("h4",{className:"roomsHeader",children:"Users"}),Object(A.jsx)(je,{currentRoom:G})]})]}),Object(A.jsxs)(X.a,{className:"main-content col-9",children:[Object(A.jsx)(Q.a,{children:Object(A.jsx)(se,{room:Z})}),Object(A.jsx)("section",{className:"messages-window",children:Object(A.jsx)("ul",{className:"messages",children:G?j:Object(A.jsxs)("li",{className:"filler-text",children:[" ",Object(A.jsx)("div",{className:"filler",children:"No room selected. Please join a room to start a conversation!"})]})})}),Object(A.jsx)($,{received:function(e){f(e)},room:G})]})]})})},Oe=function(){var e=Object(n.useContext)(l),t=e.state,a=e.dispatch,r=t.loggedIn,s=Object(i.f)(),c=Object(n.useState)(""),u=Object(o.a)(c,2),d=u[0],j=u[1],p=Object(n.useState)(""),O=Object(o.a)(p,2),h=O[0],f=O[1],x=Object(n.useState)(""),g=Object(o.a)(x,2),v=g[0],N=g[1],y=Object(n.useState)(""),k=Object(o.a)(y,2),E=k[0],I=k[1],T=Object(n.createRef)(),R=function(){var e=Object(C.a)(S.a.mark((function e(t){var r,n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),r=T.current.files[0],r.name.split(".").pop(),(c=n={email:d,userName:h,password:v,passwordConfirmation:E},_()({method:"POST",url:P+"/sign-up/",data:{credentials:{email:c.email,password:c.password,password_confirmation:c.passwordConfirmation,userName:c.userName,pfpType:c.pfpType}}})).then((function(){return L(n)})).then((function(e){D(T.current.files[0],e.data.user.userName),a({type:b,payload:e.data.user._id}),a({type:m,payload:e.data.user.token})})).then((function(){Object(w.b)("User ".concat(h," successfully created!"),{type:"success"})})).then((function(){return s.push("/")})).catch((function(e){j(""),f(""),N(""),I(""),w.b.error("Error signing up, please try again later",{position:"bottom-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}));case 5:case"end":return e.stop()}var c}),e)})));return function(t){return e.apply(this,arguments)}}();return r?Object(A.jsx)(i.a,{to:"/"}):Object(A.jsx)("div",{className:"row signup-parent-wrapper",children:Object(A.jsxs)("div",{className:"signup-form-wrapper",children:[Object(A.jsx)("h3",{className:"signup-header3",children:"Sign Up"}),Object(A.jsxs)(F.a,{className:"signup-form",onSubmit:R,children:[Object(A.jsxs)(F.a.Group,{children:[Object(A.jsx)(F.a.Label,{children:"Email address"}),Object(A.jsx)(F.a.Control,{required:!0,type:"email",name:"email",value:d,placeholder:"Enter email",onChange:function(e){return j(e.target.value)}})]}),Object(A.jsxs)(F.a.Group,{children:[Object(A.jsx)(F.a.Label,{children:"Username"}),Object(A.jsx)(F.a.Control,{required:!0,type:"username",name:"username",value:h,placeholder:"Enter username",onChange:function(e){return f(e.target.value)}})]}),Object(A.jsxs)(F.a.Group,{children:[Object(A.jsx)(F.a.Label,{children:"Password"}),Object(A.jsx)(F.a.Control,{required:!0,name:"password",value:v,type:"password",placeholder:"Password",onChange:function(e){return N(e.target.value)}})]}),Object(A.jsxs)(F.a.Group,{children:[Object(A.jsx)(F.a.Label,{children:"Password Confirmation"}),Object(A.jsx)(F.a.Control,{required:!0,name:"passwordConfirmation",value:E,type:"password",placeholder:"Confirm Password",onChange:function(e){return I(e.target.value)}})]}),Object(A.jsxs)(F.a.Group,{children:[Object(A.jsx)(F.a.Label,{children:"Profile Picture"}),Object(A.jsx)(F.a.Control,{required:!0,type:"file",name:"image",id:"imagePicker",accept:"image/*",multiple:!1,ref:T})]}),Object(A.jsx)(U.a,{variant:"primary",type:"submit",children:"Submit"})]})]})})},he=function(){var e=Object(n.useContext)(l),t=e.state,a=e.dispatch,r=t.loggedIn,s=Object(n.useState)(""),c=Object(o.a)(s,2),u=c[0],d=c[1],h=Object(n.useState)(""),f=Object(o.a)(h,2),x=f[0],g=f[1];return r?Object(A.jsx)(i.a,{to:"/"}):Object(A.jsx)("div",{className:"row signin-parent-wrapper",children:Object(A.jsxs)("div",{className:"signin-form-wrapper",children:[Object(A.jsx)("h3",{className:"signin-header3",children:"Login"}),Object(A.jsxs)(F.a,{onSubmit:function(e){e.preventDefault(),L({userName:u,password:x}).then((function(e){a({type:b,payload:e.data.user._id}),a({type:m,payload:e.data.user.token}),a({type:p,payload:!0}),a({type:j,payload:e.data.user.userName}),a({type:O,payload:e.data.user.rooms})})).catch((function(e){console.log(e),w.b.error("incorrect username or password",{position:"bottom-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}))},className:"signin-form",children:[Object(A.jsxs)(F.a.Group,{controlId:"username",children:[Object(A.jsx)(F.a.Label,{className:"label-username",children:"Username"}),Object(A.jsx)(F.a.Control,{required:!0,type:"username",name:"username",value:u,placeholder:"Enter username",onChange:function(e){return d(e.target.value)}})]}),Object(A.jsxs)(F.a.Group,{controlId:"password",children:[Object(A.jsx)(F.a.Label,{children:"Password"}),Object(A.jsx)(F.a.Control,{required:!0,name:"password",value:x,type:"password",placeholder:"Password",onChange:function(e){return g(e.target.value)}})]}),Object(A.jsx)(U.a,{variant:"primary",type:"submit",children:"Submit"})]})]})})},fe=function(){var e=Object(n.useContext)(l),t=e.state,a=e.dispatch,r=Object(i.f)(),s=t.loggedIn,c=t.token;return Object(n.useEffect)((function(){clearInterval(window.intervalId),clearInterval(window.roomIntervalId),s&&function(e){return _()({url:P+"/sign-out/",method:"DELETE",headers:{Authorization:"Bearer ".concat(e)}})}(c).finally((function(){})).finally((function(){g.forEach((function(e){a({type:e,payload:null})}))})).finally((function(){return r.push("/")}))}),[]),s?null:Object(A.jsx)(i.a,{to:"/"})},xe=(a(122),r={loggedIn:!1,userId:null,userName:null,token:null,shouldSaveState:!1},Object(u.a)(r,"userName",null),Object(u.a)(r,"rooms",[]),Object(u.a)(r,"serverUsers",[]),Object(u.a)(r,"cachedPfps",[]),r),ge=function(){var e=Object(n.useReducer)(v,xe),t=Object(o.a)(e,2),a=t[0],r=t[1];return Object(A.jsxs)(l.Provider,{value:{state:a,dispatch:r},children:[Object(A.jsx)(w.a,{}),Object(A.jsx)(K,{}),Object(A.jsxs)("main",{className:"container",children:[Object(A.jsx)(i.b,{path:"/sign-up",component:Oe}),Object(A.jsx)(i.b,{path:"/sign-in",component:he}),Object(A.jsx)(i.b,{path:"/sign-out",component:fe})]}),a.loggedIn?Object(A.jsx)(pe,{}):""]})},ve=Object(A.jsx)(N.a,{basename:"/chat-app",children:Object(A.jsx)(ge,{})});c.a.render(ve,document.getElementById("root"))},90:function(e,t,a){}},[[123,1,2]]]);
//# sourceMappingURL=main.21530753.chunk.js.map