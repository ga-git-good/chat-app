(this["webpackJsonpreact-auth-template"]=this["webpackJsonpreact-auth-template"]||[]).push([[0],{123:function(e,t,a){"use strict";a.r(t);var n,r=a(0),s=a(30),c=a.n(s),o=(a(90),a(3)),u=a(17),i=a(15),l=Object(r.createContext)(),d=a(2),j="SET_USERNAME",b="SET_USER_ID",m="SET_TOKEN",p="SET_SIGNEDIN",O="SET_ROOMS_ID",h="SET_STATE",f="SET_SERVER_USERS",x="ADD_CACHE",g=[j,b,m,p,O,f,h],v=function(e,t){switch(t.type){case x:return null===t.payload?Object(d.a)(Object(d.a)({},e),{},{cachedPfps:[]}):Object(d.a)(Object(d.a)({},e),{},{cachedPfps:t.payload});case j:return null===t.payload?Object(d.a)(Object(d.a)({},e),{},{userName:null}):Object(d.a)(Object(d.a)({},e),{},{userName:t.payload});case b:case b:return null===t.payload?Object(d.a)(Object(d.a)({},e),{},{userId:null}):Object(d.a)(Object(d.a)({},e),{},{userId:t.payload});case m:return null===t.payload?Object(d.a)(Object(d.a)({},e),{},{token:null}):Object(d.a)(Object(d.a)({},e),{},{token:t.payload});case p:return null===t.payload?Object(d.a)(Object(d.a)({},e),{},{loggedIn:!1}):Object(d.a)(Object(d.a)({},e),{},{loggedIn:t.payload});case O:return null===t.payload?Object(d.a)(Object(d.a)({},e),{},{rooms:null}):Object(d.a)(Object(d.a)({},e),{},{rooms:t.payload});case f:return null===t.payload?Object(d.a)(Object(d.a)({},e),{},{serverUsers:null}):Object(d.a)(Object(d.a)({},e),{},{serverUsers:t.payload});case h:return null===t.payload?Object(d.a)(Object(d.a)({},e),{},{shouldSaveState:!1}):Object(d.a)(Object(d.a)({},e),{},{shouldSaveState:t.payload});default:return e}},w=a(14),N=a(16),y=a(7),S=a.n(y),k=a(13),C=a(131),E="https://gg-chat-api.herokuapp.com",I="http://localhost:3040",P="localhost"===window.location.hostname?I:E,T=a(18),R=a.n(T),_=function(e){return R()({method:"DELETE",url:P+"/delete-account",headers:{Authorization:"Bearer ".concat(e)}})},D=function(){var e=Object(k.a)(S.a.mark((function e(t,a){var n,r,s;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,console.log("buffer:"),console.log(n),(r=new FormData).append("pfp",n),s={method:"POST",body:r},console.log(s),e.abrupt("return",fetch(P+"/upload/"+a,s));case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),F=function(e){return R()({url:P+"/sign-in/",method:"POST",data:{credentials:{userName:e.userName,password:e.password}}})},L=a(132),A=a(8),U=a(44),B=a(1),G=function(e){var t=e.closeModal,a=Object(r.useContext)(l),n=a.state,s=(a.dispatch,Object(i.f)()),c=n.loggedIn,u=n.token,d=Object(r.useState)(""),j=Object(o.a)(d,2),b=j[0],m=j[1],p=Object(r.useState)(""),O=Object(o.a)(p,2),h=O[0],f=O[1];return c?Object(B.jsx)("div",{className:"row changePass-parent-wrapper ",children:Object(B.jsx)("div",{className:"changePass-form-wrapper",children:Object(B.jsxs)(A.a,{className:"changePass-form",children:[Object(B.jsxs)(A.a.Group,{controlId:"oldPassword",children:[Object(B.jsx)(A.a.Label,{children:"Old password"}),Object(B.jsx)(A.a.Control,{required:!0,name:"oldPassword",value:b,type:"password",placeholder:"Old Password",onChange:function(e){return m(e.target.value)}})]}),Object(B.jsxs)(A.a.Group,{controlId:"newPassword",children:[Object(B.jsx)(A.a.Label,{children:"New Password"}),Object(B.jsx)(A.a.Control,{required:!0,name:"newPassword",value:h,type:"password",placeholder:"New Password",onChange:function(e){return f(e.target.value)}})]}),Object(B.jsx)(U.a,{variant:"primary",type:"button",onClick:function(){(function(e,t){return console.log(e,t,"Hello thereerer"),R()({url:P+"/change-password/",method:"PATCH",headers:{Authorization:"Bearer ".concat(t)},data:{passwords:{old:e.old,new:e.new}}})})({old:b,new:h},u).then((function(e){t(),console.log(props,"kaskdakddkadasndakdaksdkandakdsd")})).then((function(){return s.push("/")})).catch((function(e){f(""),m("")}))},children:"Submit"})]})})}):Object(B.jsx)(i.a,{to:"/"})},H=function(e){e.title;var t=Object(r.useState)(!1),a=Object(o.a)(t,2),n=a[0],s=a[1],c=function(){return s(!1)};return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(N.b,{to:"/change-password",className:"nav-link",onClick:function(){return s(!0)},children:"Change Password"}),Object(B.jsxs)(L.a,{show:n,onHide:c,centered:!0,children:[Object(B.jsx)(L.a.Header,{closeButton:!0,children:Object(B.jsx)(L.a.Title,{className:"changePass-modal-title",children:"Change Password"})}),Object(B.jsx)(L.a.Body,{children:Object(B.jsx)(i.b,{path:"/change-password",render:function(){return Object(B.jsx)(G,{closeModal:c})}})})]})]})},z=function(e){var t=e.closeModal,a=Object(r.useContext)(l),n=a.state,s=(a.dispatch,n.loggedIn),c=Object(r.createRef)(),o=function(){var e=Object(k.a)(S.a.mark((function e(a){var r;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),console.log(c.current.files[0]),e.next=4,D(c.current.files[0],n.userName);case 4:if(r=e.sent,console.log("upload status: ",r),200!==r.status){e.next=12;break}return w.b.success("Profile image changed successfully!"),t(),e.abrupt("return",!0);case 12:return w.b.error("Failed to change profile image"),t(),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return s?Object(B.jsx)("div",{className:"row sigin-parent-wrapper",children:Object(B.jsx)("div",{className:"sigin-form-wrapper",children:Object(B.jsxs)(A.a,{className:"signin-form",onSubmit:o,children:[Object(B.jsx)(A.a.Group,{children:Object(B.jsx)(A.a.Control,{type:"file",name:"image",id:"imagePicker",accept:"image/*",multiple:!1,ref:c})}),Object(B.jsx)(U.a,{variant:"primary",type:"submit",children:"Submit"})]})})}):Object(B.jsx)(i.a,{to:"/"})},q=function(e){e.title;var t=Object(r.useState)(!1),a=Object(o.a)(t,2),n=a[0],s=a[1],c=function(){return s(!1)};return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(N.b,{to:"/upload-image",className:"nav-link",onClick:function(){return s(!0)},children:"Upload Image"}),Object(B.jsxs)(L.a,{show:n,onHide:c,centered:!0,children:[Object(B.jsx)(L.a.Header,{children:Object(B.jsx)(L.a.Title,{className:"changePass-modal-title",children:"Change Profile Image"})}),Object(B.jsx)(L.a.Body,{children:Object(B.jsx)(i.b,{path:"/upload-image",render:function(e){return Object(B.jsx)(z,{closeModal:c})}})})]})]})},M=function(e){var t=e.user,a=Object(r.useState)(!1),n=Object(o.a)(a,2),s=(n[0],n[1],Object(r.useContext)(l)),c=s.state,u=s.dispatch,d=c.token,j=Object(i.f)(),b=function(){var e=Object(k.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_(d);case 2:200===e.sent.status?(Object(w.b)("Successfully deleted account!"),g.forEach((function(e){u({type:e,payload:null})})),j.push("/")):Object(w.b)("Failed to delete account",{type:"error"});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(B.jsx)(B.Fragment,{children:Object(B.jsxs)(C.a,{className:"parent-dropdown-wrapper",children:[Object(B.jsx)(C.a.Toggle,{className:"dropdown-username",children:t.userName}),Object(B.jsxs)(C.a.Menu,{className:"dropdown-menu",children:[Object(B.jsx)(q,{}),Object(B.jsx)(H,{}),Object(B.jsx)(C.a.Divider,{className:"divider"}),Object(B.jsx)(N.b,{to:"/sign-out",className:"nav-link",children:"Sign Out"}),Object(B.jsx)(C.a.Divider,{className:"divider"}),Object(B.jsx)("span",{onClick:function(){return b()},style:{color:"red",fontWeight:"800"},className:"nav-link",children:"Delete Account"})]})]})})},Y=function(e){return Object(B.jsx)(B.Fragment,{children:Object(B.jsx)(M,{user:e})})},J=Object(B.jsxs)(r.Fragment,{children:[Object(B.jsx)(N.b,{to:"/sign-in",className:"link login",children:"Login"}),Object(B.jsx)(N.b,{to:"/sign-up",className:"link register",children:"Register"})]}),V=function(){var e=Object(r.useContext)(l),t=e.state,a=(e.dispatch,t);return Object(B.jsxs)("div",{className:"header-wrapper",children:[Object(B.jsx)("div",{className:"logo-wrapper",children:Object(B.jsx)(N.b,{to:"/",className:"link",children:Object(B.jsx)("span",{className:"logo-text",children:"Oui Chat"})})}),Object(B.jsx)("div",{className:"links-group-1",children:a.loggedIn?Y(a):J})]})},K=a(42),W=a(129),Q=a(130),X=a(80),Z=a(84),$=function(e){var t=e.received,a=e.room,n=Object(r.useContext)(l),s=n.state,c=(n.dispatch,s.loggedIn,s.userId,s.token),u=s.userName,i=Object(r.useState)(""),d=Object(o.a)(i,2),j=d[0],b=d[1],m=Object(r.useState)(null),p=Object(o.a)(m,2),O=p[0],h=p[1],f=Object(r.useState)(!1),x=Object(o.a)(f,2),g=x[0],v=x[1],N=Object(r.useState)(!1),y=Object(o.a)(N,2),S=(y[0],y[1]);Object(r.useEffect)((function(){if(!g){console.log("connecting socket");var e=Object(Z.a)(P,{withCredentials:!1,query:{token:c}});e.on("connect",(function(){window.socket=e,console.log("connected!")})),e.on("loggedin",(function(a){a?(S(!0),e.on("message",t),e.on("unauthorized",(function(){Object(w.b)("Unauthorized",{type:"error"})}))):(console.log("failed to log in"),Object(w.b)("failed to log in"))})),h(e),v(!0)}}),[]),Object(r.useEffect)((function(){console.log("seeing this pop up here as well",a),a&&O.emit("join",{roomId:a})}),[a]);return Object(B.jsx)(B.Fragment,{children:""!==a?Object(B.jsxs)("form",{className:"message-input-window",onSubmit:function(e){if(e.preventDefault(),O){var t={message:j,roomId:a,timestamp:(new Date).toLocaleString(),userName:u};O.emit("send-message",t),console.log("sent message: "),console.log(t),b("")}},children:[Object(B.jsx)("input",{value:j,onChange:function(e){return b(e.target.value)},className:"message-input"}),Object(B.jsx)("button",{type:"submit",className:"send-message",children:"Send"})]}):""})},ee=function(){var e=Object(k.a)(S.a.mark((function e(t,a,n){var r,s,c,o;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=window.sessionStorage,s=t.filter((function(e){return!a.some((function(t){return t!==e._id}))})),e.prev=2,e.next=5,Promise.all(s.map(function(){var e=Object(k.a)(S.a.mark((function e(t){var a,n,r,s;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={userName:t.userName},e.next=3,fetch(P+"/img/"+t.userName);case 3:return n=e.sent,r=n.headers.get("Content-Type"),e.next=7,n.arrayBuffer();case 7:return s=e.sent,a.data=ae(r,s),e.abrupt("return",a);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:return c=e.sent,o=0===a.length?[]:Object(K.a)(a),c.forEach((function(e){r.setItem(e.userName,e.data),o.push(e.userName)})),n({type:x,payload:o}),e.abrupt("return",!0);case 12:return e.prev=12,e.t0=e.catch(2),console.error(e.t0),e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(t,a,n){return e.apply(this,arguments)}}(),te=function(e){var t=window.sessionStorage.getItem(e);return t||P+"/img/"+e},ae=function(e,t){var a="data:".concat(e,";base64,"),n="";return new Uint8Array(t).forEach((function(e){return n+=String.fromCharCode(e)})),a+window.btoa(n)},ne={color:"rgba(123, 115, 115, .85)"},re=function(e){console.log("imgurl:");var t=P+"/img/"+e.userName;return console.log(t),Object(B.jsxs)("div",{className:"message-layout",children:[Object(B.jsx)("img",{col:"1",className:"userImage",src:te(e.userName)}),Object(B.jsxs)("li",{col:"2",children:[Object(B.jsx)("strong",{children:e.userName})," ",Object(B.jsx)("a",{style:ne,children:e.timestamp}),":",Object(B.jsx)("br",{}),Object(B.jsx)("section",{className:"message-text",children:e.text})]})]})},se=function(e){var t=e.room;return Object(r.useEffect)((function(){console.log("in room: ",t)}),[t]),Object(B.jsx)(B.Fragment,{children:t?Object(B.jsx)("h3",{className:"room-title",children:t}):""})},ce=function(e,t,a){return R()({method:"POST",url:P+"/create-room",headers:{Authorization:"Bearer ".concat(a)},data:{room:{name:e},userId:t}})},oe=function(e){return R()({method:"GET",url:P+"/show-rooms",headers:{Authorization:"Bearer ".concat(e)}})},ue=function(e){return R()({method:"DELETE",url:P+"/go-offline",headers:{Authorization:"Bearer ".concat(e)}})},ie=function(e){return R()({method:"GET",url:P+"/show-server-users",headers:{Authorization:"Bearer ".concat(e)}})},le=function(e){var t=e.name,a=e.status,n=e.add,s=e.userId;return Object(r.useEffect)((function(){}),[a]),Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("img",{col:"1",className:"user-image",src:te(t)}),Object(B.jsx)("span",{className:"user-name",children:t}),Object(B.jsx)("span",{className:"user-status",children:"online"===a?Object(B.jsx)("img",{src:"https://icongr.am/octicons/rss.svg?size=16&color=36ba38"}):""}),Object(B.jsx)("img",{src:"https://icongr.am/octicons/plus.svg?size=16&color=b3b3b3",onClick:function(){return n(s)}})]})},de=function(e,t,a){return R()({method:"POST",url:P+"/add-user-to-room",headers:{Authorization:"Bearer ".concat(a)},data:{roomId:e,userId:t}})},je=function(e){var t=e.currentRoom,a=Object(r.useContext)(l),n=a.state,s=a.dispatch,c=n.serverUsers,u=n.token,i=Object(r.useState)(null),d=Object(o.a)(i,2),j=d[0],b=d[1],m=function(){var e=Object(k.a)(S.a.mark((function e(a){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&""!==t){e.next=3;break}return Object(w.b)("Please select a room in order to add users."),e.abrupt("return");case 3:return e.next=5,de(t,a,u);case 5:if(201!==e.sent.status){e.next=11;break}return Object(w.b)("User successfully added to room!",{type:"success"}),e.abrupt("return");case 11:return Object(w.b)("You may not add a user to that room.",{type:"error"}),e.abrupt("return");case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(k.a)(S.a.mark((function e(){var t,a;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie(u);case 2:return a=e.sent,t=a.data.user,e.next=6,s({type:f,payload:t});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){p();var e=setInterval(p,5e3);window.intervalId=e}),[]),Object(r.useEffect)(Object(k.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("server users: ",c),c&&b(c.map((function(e){return Object(B.jsx)("li",{className:"user-list-item",children:Object(B.jsx)(le,{name:e.userName,userId:e._id,add:m,status:e.status})},e._id)})));case 2:case"end":return e.stop()}}),e)}))),[c]),Object(B.jsx)("ul",{className:"user-list",children:j})},be=function(e){var t=e.setRoomName,a=e.onCreateRoom,n=e.roomName,s=Object(r.useState)(!1),c=Object(o.a)(s,2),u=c[0],i=c[1];return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(U.a,{className:"create-room-button",onClick:function(){return i(!0)},children:Object(B.jsx)("span",{className:"create-room-span",children:"+"})}),Object(B.jsxs)(L.a,{show:u,onHide:function(){return i(!1)},centered:!0,children:[Object(B.jsx)(L.a.Header,{closeButton:!0,children:Object(B.jsx)(L.a.Title,{className:"createRoom-modal-title",children:"Create Room"})}),Object(B.jsx)(L.a.Body,{children:Object(B.jsx)(A.a,{onSubmit:function(e){return a(e.handleClose)},children:Object(B.jsxs)(A.a.Group,{controlId:"room-name",children:[Object(B.jsx)(A.a.Control,{required:!0,type:"room-name",name:"create-room",value:n,placeholder:"Enter Room Name",onChange:function(e){return t(e.target.value)}}),Object(B.jsx)("button",{type:"submit",className:"create-button",children:"Create"})]})})})]})]})},me=function(){var e=Object(k.a)(S.a.mark((function e(t,a){var n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R()({method:"GET",url:P+"/room/"+a,headers:{Authorization:"Bearer ".concat(t)}});case 2:if(0!==(n=e.sent).data.length){e.next=5;break}return e.abrupt("return",null);case 5:return e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),pe=function(){var e=Object(r.createRef)();return Object(r.useEffect)((function(){return e.current.scrollIntoView({behavior:"smooth"})})),Object(B.jsx)("div",{ref:e})},Oe=function(){var e=Object(r.useContext)(l),t=e.state,a=e.dispatch,n=Object(r.useState)([]),s=Object(o.a)(n,2),c=s[0],u=s[1],i=Object(r.useState)([]),d=Object(o.a)(i,2),j=d[0],b=d[1],m=Object(r.useState)(null),p=Object(o.a)(m,2),h=p[0],f=p[1],x=Object(r.useState)(""),g=Object(o.a)(x,2),v=g[0],N=g[1],y=t.rooms,C=t.userId,E=t.token,I=t.serverUsers,P=t.cachedPfps,T=Object(r.useState)(null),R=Object(o.a)(T,2),_=R[0],D=R[1],F=Object(r.useState)(null),L=Object(o.a)(F,2),A=(L[0],L[1],Object(r.useState)("")),U=Object(o.a)(A,2),G=U[0],H=U[1],z=Object(r.useState)(""),q=Object(o.a)(z,2),M=q[0],Y=q[1],J=Object(r.useState)(""),V=Object(o.a)(J,2),Z=V[0],te=V[1],ae=Object(r.useState)(""),ne=Object(o.a)(ae,2),ie=ne[0],le=ne[1];Object(r.useEffect)((function(){I&&0!==I.length&&ee(I,P,a).then((function(e){e||console.error("failed to cache images")}))}),[I]);var de=function e(t){if(console.log(t),t){Object(w.b)("Successfully deleted room!",{type:"success"});var n=y.filter((function(e){return e._id!==t}));a({type:O,payload:n})}else Object(w.b)("You may not delete that room.",{type:"error"});window.socket.removeEventListener("deleted",e)};Object(r.useEffect)((function(){M!==G&&(u([]),H(M),te(ie))}),[M]),Object(r.useEffect)((function(){""!==G&&me(E,G).then((function(e){if(console.log("MESSAGE HISTORY"),e){var t=e.map((function(e){return{userName:e.userName,timestamp:e.sentAt,message:e.text}}));console.log("FETCHED HISTORY"),console.log(t),u(t)}}))}),[G]),Object(r.useEffect)((function(){(null===y||void 0===y?void 0:y.length)>0&&D(y.map((function(e){return Object(B.jsxs)("li",{className:"room-list-item",children:[Object(B.jsx)("a",{href:"#",className:"room-name-link",onClick:function(){return function(e,t){console.log("changing room to: ",e),Y(e),le(t)}(e._id,e.name)},children:"".concat(e.name)}),Object(B.jsx)("img",{className:"trash",src:"https://icongr.am/octicons/trash.svg?size=16&color=FFFFFF",onClick:function(){return function(e){var t={roomId:e,timestamp:(new Date).toLocaleString(),userId:C};window.socket.emit("delete-room",t),window.socket.addEventListener("deleted",de)}(e._id)}})]},"".concat(e._id))})))}),[y]);var Oe=function(){var e=Object(k.a)(S.a.mark((function e(){var t,n;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("updateRooms called"),t=[],e.next=4,oe(E);case 4:n=e.sent,n.data.room.forEach((function(e){e.validUsers.includes(C)&&t.push(e)})),a({type:O,payload:t});case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)(Object(k.a)(S.a.mark((function e(){var t;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("running once:"),Oe(),t=setInterval(Oe,5e3),window.roomIntervalId=t,window.addEventListener("beforeunload",(function(){ue(E,C)}),!1);case 5:case"end":return e.stop()}}),e)}))),[]);var he=function(){var e=Object(k.a)(S.a.mark((function e(t,n){var r,s;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),r=[],e.next=4,ce(v,C,E);case 4:s=e.sent,y.length>0?(n(),(r=Object(K.a)(y)).push(s.data.room)):r=[s.data.room],a({type:O,payload:r});case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){if(h){var e=Object(K.a)(c);e.push(h),u(e),f(null)}}),[h]),Object(r.useEffect)((function(){b(c.map((function(e,t){return Object(B.jsx)(re,{userName:e.userName,timestamp:e.timestamp,text:e.message},e.userName+t.toString())})))}),[c]),Object(B.jsx)(W.a,{className:"main-container",children:Object(B.jsxs)(Q.a,{className:"top-row",children:[Object(B.jsxs)(X.a,{className:"col-3 left-side-options",children:[Object(B.jsx)("h3",{className:"room-title-alt",children:Object(B.jsx)(se,{room:Z})}),Object(B.jsxs)("div",{className:"left-side-nav",children:[Object(B.jsx)(Q.a,{className:"room-top-level",children:Object(B.jsxs)("div",{className:"rooms-div",children:[Object(B.jsx)("h4",{className:"roomsHeader",children:"Rooms"}),Object(B.jsx)(be,{onCreateRoom:he,roomName:v,setRoomName:N})]})}),Object(B.jsx)(Q.a,{children:Object(B.jsx)("section",{className:"open-rooms",children:Object(B.jsx)("ul",{className:"room-list",children:_})})})]}),Object(B.jsxs)(Q.a,{className:"active-users",children:[Object(B.jsx)("h4",{className:"roomsHeader",children:"Users"}),Object(B.jsx)(je,{currentRoom:G})]})]}),Object(B.jsxs)(X.a,{className:"main-content col-9",children:[Object(B.jsx)(Q.a,{children:Object(B.jsx)(se,{room:Z})}),Object(B.jsx)("section",{className:"messages-window",children:Object(B.jsxs)("ul",{className:"messages",children:[G?j:Object(B.jsxs)("li",{className:"filler-text",children:[" ",Object(B.jsx)("div",{className:"filler",children:"No room selected. Please join a room to start a conversation!"})]}),Object(B.jsx)(pe,{})]})}),Object(B.jsx)($,{received:function(e){f(e)},room:G})]})]})})},he=function(){var e=Object(r.useContext)(l),t=e.state,a=e.dispatch,n=t.loggedIn,s=Object(i.f)(),c=Object(r.useState)(""),u=Object(o.a)(c,2),d=u[0],j=u[1],p=Object(r.useState)(""),O=Object(o.a)(p,2),h=O[0],f=O[1],x=Object(r.useState)(""),g=Object(o.a)(x,2),v=g[0],N=g[1],y=Object(r.useState)(""),C=Object(o.a)(y,2),E=C[0],I=C[1],T=Object(r.createRef)(),_=function(){var e=Object(k.a)(S.a.mark((function e(t){var n,r,c;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),console.log(T.current),console.log(T.current.files),n=T.current.files[0],r=n.name.split(".").pop(),console.log(r),(o=c={email:d,userName:h,password:v,passwordConfirmation:E},R()({method:"POST",url:P+"/sign-up/",data:{credentials:{email:o.email,password:o.password,password_confirmation:o.passwordConfirmation,userName:o.userName,pfpType:o.pfpType}}})).then((function(){return F(c)})).then((function(e){D(T.current.files[0],e.data.user.userName),a({type:b,payload:e.data.user._id}),a({type:m,payload:e.data.user.token})})).then((function(){Object(w.b)("User ".concat(h," successfully created!"),{type:"success"})})).then((function(){return s.push("/")})).catch((function(e){j(""),f(""),N(""),I("")}));case 8:case"end":return e.stop()}var o}),e)})));return function(t){return e.apply(this,arguments)}}();return n?Object(B.jsx)(i.a,{to:"/"}):Object(B.jsx)("div",{className:"row signup-parent-wrapper",children:Object(B.jsxs)("div",{className:"signup-form-wrapper",children:[Object(B.jsx)("h3",{className:"signup-header3",children:"Sign Up"}),Object(B.jsxs)(A.a,{className:"signup-form",onSubmit:_,children:[Object(B.jsxs)(A.a.Group,{children:[Object(B.jsx)(A.a.Label,{children:"Email address"}),Object(B.jsx)(A.a.Control,{required:!0,type:"email",name:"email",value:d,placeholder:"Enter email",onChange:function(e){return j(e.target.value)}})]}),Object(B.jsxs)(A.a.Group,{children:[Object(B.jsx)(A.a.Label,{children:"Username"}),Object(B.jsx)(A.a.Control,{required:!0,type:"username",name:"username",value:h,placeholder:"Enter username",onChange:function(e){return f(e.target.value)}})]}),Object(B.jsxs)(A.a.Group,{children:[Object(B.jsx)(A.a.Label,{children:"Password"}),Object(B.jsx)(A.a.Control,{required:!0,name:"password",value:v,type:"password",placeholder:"Password",onChange:function(e){return N(e.target.value)}})]}),Object(B.jsxs)(A.a.Group,{children:[Object(B.jsx)(A.a.Label,{children:"Password Confirmation"}),Object(B.jsx)(A.a.Control,{required:!0,name:"passwordConfirmation",value:E,type:"password",placeholder:"Confirm Password",onChange:function(e){return I(e.target.value)}})]}),Object(B.jsxs)(A.a.Group,{children:[Object(B.jsx)(A.a.Label,{children:"Profile Picture"}),Object(B.jsx)(A.a.Control,{type:"file",name:"image",id:"imagePicker",accept:"image/*",multiple:!1,ref:T})]}),Object(B.jsx)(U.a,{variant:"primary",type:"submit",children:"Submit"})]})]})})},fe=function(){var e=Object(r.useContext)(l),t=e.state,a=e.dispatch,n=t.loggedIn,s=Object(r.useState)(""),c=Object(o.a)(s,2),u=c[0],d=c[1],h=Object(r.useState)(""),f=Object(o.a)(h,2),x=f[0],g=f[1];return n?Object(B.jsx)(i.a,{to:"/"}):Object(B.jsx)("div",{className:"row signin-parent-wrapper",children:Object(B.jsxs)("div",{className:"signin-form-wrapper",children:[Object(B.jsx)("h3",{className:"signin-header3",children:"Login"}),Object(B.jsxs)(A.a,{onSubmit:function(e){e.preventDefault(),F({userName:u,password:x}).then((function(e){a({type:b,payload:e.data.user._id}),a({type:m,payload:e.data.user.token}),a({type:p,payload:!0}),a({type:j,payload:e.data.user.userName}),a({type:O,payload:e.data.user.rooms})})).catch((function(e){console.log(e),w.b.error("incorrect username or password",{position:"bottom-center",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}))},className:"signin-form",children:[Object(B.jsxs)(A.a.Group,{controlId:"username",children:[Object(B.jsx)(A.a.Label,{className:"label-username",children:"Username"}),Object(B.jsx)(A.a.Control,{required:!0,type:"username",name:"username",value:u,placeholder:"Enter username",onChange:function(e){return d(e.target.value)}})]}),Object(B.jsxs)(A.a.Group,{controlId:"password",children:[Object(B.jsx)(A.a.Label,{children:"Password"}),Object(B.jsx)(A.a.Control,{required:!0,name:"password",value:x,type:"password",placeholder:"Password",onChange:function(e){return g(e.target.value)}})]}),Object(B.jsx)(U.a,{variant:"primary",type:"submit",children:"Submit"})]})]})})},xe=function(){var e=Object(r.useContext)(l),t=e.state,a=e.dispatch,n=Object(i.f)(),s=t.loggedIn,c=t.token;return Object(r.useEffect)((function(){clearInterval(window.intervalId),clearInterval(window.roomIntervalId),s&&function(e){return R()({url:P+"/sign-out/",method:"DELETE",headers:{Authorization:"Bearer ".concat(e)}})}(c).finally((function(){})).finally((function(){g.forEach((function(e){console.log(e),a({type:e,payload:null})}))})).finally((function(){return n.push("/")}))}),[]),s?null:Object(B.jsx)(i.a,{to:"/"})},ge=(a(122),n={loggedIn:!1,userId:null,userName:null,token:null,shouldSaveState:!1},Object(u.a)(n,"userName",null),Object(u.a)(n,"rooms",[]),Object(u.a)(n,"serverUsers",[]),Object(u.a)(n,"cachedPfps",[]),n),ve=function(){var e=Object(r.useReducer)(v,ge),t=Object(o.a)(e,2),a=t[0],n=t[1];return Object(B.jsxs)(l.Provider,{value:{state:a,dispatch:n},children:[Object(B.jsx)(w.a,{}),Object(B.jsx)(V,{}),Object(B.jsxs)("main",{className:"container",children:[Object(B.jsx)(i.b,{path:"/sign-up",component:he}),Object(B.jsx)(i.b,{path:"/sign-in",component:fe}),Object(B.jsx)(i.b,{path:"/sign-out",component:xe})]}),a.loggedIn?Object(B.jsx)(Oe,{}):""]})},we=Object(B.jsx)(N.a,{basename:"/chat-app",children:Object(B.jsx)(ve,{})});c.a.render(we,document.getElementById("root"))},90:function(e,t,a){}},[[123,1,2]]]);
//# sourceMappingURL=main.b23fe1af.chunk.js.map